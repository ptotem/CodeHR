<h1>This is my page</h1>
<div class=row-fluid>
  <div class=span6>
    <button class="btn btn-small btn-primary" onclick="add_to_report($(this), class_name)"> Add to Report </button>
  </div>
  <div class=span6>
    <button class="btn btn-small btn-primary"> New Report </button>
    <!--<button class="btn btn-small" id="btnExport">Export Report </button>-->
  </div>
</div>
<div class="row-fluid">
  <div class="span6">
    <input type="button" onclick="tableToExcel('report_table', 'W3C Example Table')" value="Export to CSV">

    <!--<table id="testTable" summary="Code page support in different versions of MS Windows." rules="groups" frame="hsides" border="2"><caption>CODE-PAGE SUPPORT IN MICROSOFT WINDOWS</caption><colgroup align="center"></colgroup><colgroup align="left"></colgroup><colgroup span="2" align="center"></colgroup><colgroup span="3" align="center"></colgroup><thead valign="top"><tr><th>Code-Page<br>ID</th><th>Name</th><th>ACP</th><th>OEMCP</th><th>Windows<br>NT 3.1</th><th>Windows<br>NT 3.51</th><th>Windows<br>95</th></tr></thead><tbody><tr><td>1200</td><td style="background-color: #00f; color: #fff">Unicode (BMP of ISO/IEC-10646)</td><td></td><td></td><td>X</td><td>X</td><td>*</td></tr><tr><td>1250</td><td style="font-weight: bold">Windows 3.1 Eastern European</td><td>X</td><td></td><td>X</td><td>X</td><td>X</td></tr><tr><td>1251</td><td>Windows 3.1 Cyrillic</td><td>X</td><td></td><td>X</td><td>X</td><td>X</td></tr><tr><td>1252</td><td>Windows 3.1 US (ANSI)</td><td>X</td><td></td><td>X</td><td>X</td><td>X</td></tr><tr><td>1253</td><td>Windows 3.1 Greek</td><td>X</td><td></td><td>X</td><td>X</td><td>X</td></tr><tr><td>1254</td><td>Windows 3.1 Turkish</td><td>X</td><td></td><td>X</td><td>X</td><td>X</td></tr><tr><td>1255</td><td>Hebrew</td><td>X</td><td></td><td></td><td></td><td>X</td></tr><tr><td>1256</td><td>Arabic</td><td>X</td><td></td><td></td><td></td><td>X</td></tr><tr><td>1257</td><td>Baltic</td><td>X</td><td></td><td></td><td></td><td>X</td></tr><tr><td>1361</td><td>Korean (Johab)</td><td>X</td><td></td><td></td><td>**</td><td>X</td></tr></tbody><tbody><tr><td>437</td><td>MS-DOS United States</td><td></td><td>X</td><td>X</td><td>X</td><td>X</td></tr><tr><td>708</td><td>Arabic (ASMO 708)</td><td></td><td>X</td><td></td><td></td><td>X</td></tr><tr><td>709</td><td>Arabic (ASMO 449+, BCON V4)</td><td></td><td>X</td><td></td><td></td><td>X</td></tr><tr><td>710</td><td>Arabic (Transparent Arabic)</td><td></td><td>X</td><td></td><td></td><td>X</td></tr><tr><td>720</td><td>Arabic (Transparent ASMO)</td><td></td><td>X</td><td></td><td></td><td>X</td></tr></tbody></table>-->
  </div>
</div>
<hr>
<div class="table-header">Listing Selected Object's Field/Value</div>
<table id="report_table" summary="Code page support in different versions of MS Windows." rules="groups" frame="hsides" class="table table-striped table-bordered table-hover">
  <!--<caption>CODE-PAGE SUPPORT IN MICROSOFT WINDOWS</caption>-->
  <colgroup align="center"></colgroup>
  <colgroup align="left"></colgroup>
  <colgroup span="2" align="center"></colgroup>
  <colgroup span="3" align="center"></colgroup>
  <thead valign="top">
<tr>
  <% (@fields + @assarr).each do |i| %>
    <th><%= i %></th>
  <% end %>
</tr>
</thead>
<tbody id="dis_tab">
    <% @final_array.each do |trow| %>
        <%= trow["kras"] %>
        <tr>
          <% (@fields + @assarr).each do |tcol| %>
              <td>
                <% trow["kras"] %>
                <%= trow[tcol] %>
              </td>
          <% end %>
        </tr>
    <% end %>
</tbody>
</table>
<script src ="/assets/jquery.dataTables.min.js"></script>
<script>
//    $("#report_table").dataTable({
//        "bStateSave": true,
//        "bJQueryUI": true,
//        "sPaginationType": "full_numbers",
//        "bProcessing": true,
//        "bServerSide": true,
////        "sAjaxSource": $('#report_table').data('source'),
//        "bScrollInfinite": true,
//        "bScrollCollapse": true,
//        "iDisplayLength": 100,
//        "sScrollY": "500px",
//        "sScrollX": "100%",
//        "sDom": '<"H"TCfr>t<"F"ip>',
//        "oTableTools": {
//            "aButtons": [
//                "copy",
//                "csv",
//                "xls",
//                {
//                    "sExtends": "pdf",
//                    "sPdfOrientation": "landscape",
//                    "sPdfMessage": "Your custom message would go here."
//                },
//                "print"
//            ]
//        }
//    });

    $("#btnExport").click(function(e) {
        window.open('data:application/vnd.ms-excel,' + encodeURIComponent($('#dvData').html()));
        e.preventDefault();
   	});
</script>