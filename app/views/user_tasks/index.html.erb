<div class="row-fluid">
  <div class="span4">
    <%= link_to 'New User task', new_user_task_path, :class=>"btn btn-info" %>
  </div>
</div>

<br>

<div class="row-fluid">
  <div class="span12">
    <div class="table-header">Listing User Tasks</div>
    <table id="user_tasks_table" class="table table-striped table-bordered table-hover">
      <thead>
        <tr>
          <th class="center">
            <label><input type="checkbox" id="select_all_records"/><span class="lbl"></span></label>
          </th>
          <th>Title</th>
          <th>Description</th>
          <th>Seen</th>
          <th></th>
          <th></th>
          <!--<th></th>-->
          <th><%= link_to 'Destroy All', destroy_all_user_tasks_path, method: :delete, data: { confirm: 'Are you sure?' }, :id=>"delete_all_btn" %></th>
        </tr>
      <thead>

      <tbody>
      <% @user_tasks.each do |user_task| %>
          <tr id="<%= user_task.id %>">
            <td class='center'>
              <label><input type='checkbox' /><span class="lbl"></span></label>
            </td>
            <td><%= user_task.title %></td>
            <td><%= user_task.description %></td>
            <td><%= user_task.seen %></td>
            <td><%= link_to 'Show', user_task %></td>
            <td><%= link_to 'Edit', edit_user_task_path(user_task) %></td>
            <!--<td><%#= link_to 'Destroy', user_task, method: :delete, data: { confirm: 'Are you sure?' } %></td>-->
            <td></td>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>

<%= javascript_include_tag "jquery.dataTables.min" %>
<%= javascript_include_tag "jquery.dataTables.zbootstrap" %>
<%= javascript_include_tag "custom_dataTable" %>


<script>
    $(function(){
        apply_dataTable('#user_tasks_table', '#user_tasks_table_wrapper','#user_tasks_table_length', '#user_tasks_table_filter');

        $('table#user_tasks_table th input:checkbox').on('click' , function(){
            var that = this;

            //$(this).closest('table').find('tr').each(function(){
            //console.log($(this).attr('id'));
            //});
            toggle_link();

            $(this).closest('table').find('tr > td:first-child input:checkbox')
                    .each(function(){
                        this.checked = that.checked;
                        $(this).closest('tr').toggleClass('selected');
                    });

        });

        toggle_link();

    });

    function toggle_link(){
        if (!$('#select_all_records').is(":checked"))
        {
            $('#delete_all_btn').css('pointer-events','none');
            $('#delete_all_btn').css('color','gray');
        }
        else{
            $('#delete_all_btn').css('pointer-events','auto');
            $('#delete_all_btn').css('color','#0088CC');
        }
    }
</script>